<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ASIANG | Sistem Panel Nasabah Premium</title>

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">

  <!-- Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { 
            sans: ['Plus Jakarta Sans', 'sans-serif'],
            poppins: ['Poppins', 'sans-serif']
          },
          colors: {
            primary: '#2563eb',
            secondary: '#0ea5e9',
            success: '#10b981',
            danger: '#ef4444',
            warning: '#f59e0b',
            dark: '#0f172a',
            'dark-light': '#1e293b',
            indigo: {
              500: '#6366f1',
              600: '#4f46e5',
              700: '#4338ca',
              800: '#3730a3'
            },
            orange: {
              500: '#f97316',
              600: '#ea580c',
              700: '#c2410c',
              800: '#9a3412'
            }
          },
          animation: {
            'slide-in': 'slideIn 0.3s ease-out',
            'fade-in': 'fadeIn 0.5s ease-out',
            'scale-in': 'scaleIn 0.3s ease-out',
            'float': 'float 3s ease-in-out infinite',
            'slide-down': 'slideDown 0.3s ease-out',
            'slide-up': 'slideUp 0.3s ease-out',
            'bounce-in': 'bounceIn 0.6s ease-out',
            'pulse-glow': 'pulseGlow 2s ease-in-out infinite',
            'notification-slide': 'notificationSlide 0.5s ease-out',
            'notification-hide': 'notificationHide 0.5s ease-out',
            'lock-spin': 'lockSpin 2s ease-in-out',
            'lock-float': 'lockFloat 3s ease-in-out infinite',
            'x-rotate': 'xRotate 0.6s ease-out',
            'pulse-soft': 'pulseSoft 2s ease-in-out infinite',
            'glow': 'glow 3s ease-in-out infinite'
          },
          keyframes: {
            slideIn: {
              '0%': { transform: 'translateY(10px)', opacity: 0 },
              '100%': { transform: 'translateY(0)', opacity: 1 }
            },
            fadeIn: {
              '0%': { opacity: 0 },
              '100%': { opacity: 1 }
            },
            scaleIn: {
              '0%': { transform: 'scale(0.95)', opacity: 0 },
              '100%': { transform: 'scale(1)', opacity: 1 }
            },
            float: {
              '0%, 100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-5px)' }
            },
            slideDown: {
              '0%': { transform: 'translateY(-20px)', opacity: 0 },
              '100%': { transform: 'translateY(0)', opacity: 1 }
            },
            slideUp: {
              '0%': { transform: 'translateY(20px)', opacity: 0 },
              '100%': { transform: 'translateY(0)', opacity: 1 }
            },
            bounceIn: {
              '0%': { transform: 'scale(0.3)', opacity: 0 },
              '50%': { transform: 'scale(1.05)', opacity: 1 },
              '70%': { transform: 'scale(0.9)', opacity: 1 },
              '100%': { transform: 'scale(1)', opacity: 1 }
            },
            pulseGlow: {
              '0%, 100%': { boxShadow: '0 0 20px rgba(16, 185, 129, 0.4)' },
              '50%': { boxShadow: '0 0 40px rgba(16, 185, 129, 0.7)' }
            },
            notificationSlide: {
              '0%': { transform: 'translateX(100%)', opacity: 0 },
              '100%': { transform: 'translateX(0)', opacity: 1 }
            },
            notificationHide: {
              '0%': { transform: 'translateX(0)', opacity: 1 },
              '100%': { transform: 'translateX(100%)', opacity: 0 }
            },
            lockSpin: {
              '0%': { transform: 'rotate(0deg) scale(0.8)' },
              '50%': { transform: 'rotate(180deg) scale(1.2)' },
              '100%': { transform: 'rotate(360deg) scale(1)' }
            },
            lockFloat: {
              '0%, 100%': { transform: 'translateY(0) rotate(0deg)' },
              '33%': { transform: 'translateY(-10px) rotate(5deg)' },
              '66%': { transform: 'translateY(5px) rotate(-5deg)' }
            },
            xRotate: {
              '0%': { transform: 'rotate(0deg) scale(0.5)', opacity: 0 },
              '100%': { transform: 'rotate(180deg) scale(1)', opacity: 1 }
            },
            pulseSoft: {
              '0%, 100%': { opacity: 1 },
              '50%': { opacity: 0.7 }
            },
            glow: {
              '0%, 100%': { filter: 'drop-shadow(0 0 10px rgba(16, 185, 129, 0.3))' },
              '50%': { filter: 'drop-shadow(0 0 20px rgba(16, 185, 129, 0.6))' }
            }
          }
        }
      }
    }
  </script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    .glass-card {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .gradient-border {
      position: relative;
      border: 2px solid transparent;
      background: linear-gradient(white, white) padding-box,
                  linear-gradient(135deg, #2563eb, #0ea5e9) border-box;
    }

    .btn-glow {
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .btn-glow:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(37, 99, 235, 0.3);
    }

    .input-enhanced {
      transition: all 0.2s ease;
      border: 2px solid #e2e8f0;
    }

    .input-enhanced:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
      outline: none;
    }

    .page-enter {
      animation: slideIn 0.4s ease-out forwards;
    }

    .checkmark {
      animation: checkmark 0.5s ease-out;
    }

    @keyframes checkmark {
      0% { transform: scale(0); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }

    .pulse-important {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }

    .modal-overlay {
      backdrop-filter: blur(8px);
    }

    .package-success {
      position: relative;
      overflow: hidden;
    }

    .package-success::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(16, 185, 129, 0.2), transparent);
      transition: left 0.6s;
    }

    .package-success:hover::before {
      left: 100%;
    }

    .notification-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      min-width: 20px;
      height: 20px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: bold;
      animation: pulseGlow 2s infinite;
    }

    .shimmer {
      background: linear-gradient(90deg, 
        rgba(255,255,255,0) 0%, 
        rgba(255,255,255,0.6) 50%, 
        rgba(255,255,255,0) 100%);
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }

    .notification-system {
      position: fixed;
      top: 100px;
      right: 30px;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-width: 350px;
    }

    .notification {
      animation: notificationSlide 0.5s ease-out;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
      min-width: 300px;
      transform: translateX(0);
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .notification:hover {
      transform: scale(1.02);
      box-shadow: 0 15px 50px rgba(0, 0, 0, 0.15);
    }

    .notification.success {
      background: linear-gradient(135deg, #d1fae5, #a7f3d0);
      border-left: 4px solid #10b981;
    }

    .notification.error {
      background: linear-gradient(135deg, #fee2e2, #fecaca);
      border-left: 4px solid #ef4444;
    }

    .notification.warning {
      background: linear-gradient(135deg, #fef3c7, #fde68a);
      border-left: 4px solid #f59e0b;
    }

    .notification.info {
      background: linear-gradient(135deg, #dbeafe, #bfdbfe);
      border-left: 4px solid #3b82f6;
    }

    @keyframes notificationSlide {
      0% { transform: translateX(100%); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }

    @keyframes notificationHide {
      0% { transform: translateX(0); opacity: 1; }
      100% { transform: translateX(100%); opacity: 0; }
    }

    .sidebar {
      width: 288px;
      background: linear-gradient(to bottom, #0f172a, #1e293b);
      color: white;
      padding: 32px;
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
    }

    .logo-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      background: linear-gradient(135deg, #2563eb, #0ea5e9);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px rgba(37, 99, 235, 0.3);
    }

    .nav-btn {
      width: 100%;
      text-align: left;
      padding: 20px;
      border-radius: 16px;
      border: 1px solid #334155;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .nav-btn:hover {
      transform: translateY(-2px);
    }

    .nav-btn-primary {
      background: linear-gradient(135deg, #1e293b, #0f172a);
    }

    .nav-btn-primary:hover {
      background: linear-gradient(135deg, rgba(6, 95, 70, 0.4), rgba(5, 150, 105, 0.4));
      border-color: rgba(16, 185, 129, 0.3);
    }

    .nav-btn-danger {
      background: linear-gradient(135deg, #1e293b, #0f172a);
    }

    .nav-btn-danger:hover {
      background: linear-gradient(135deg, rgba(153, 27, 27, 0.4), rgba(225, 29, 72, 0.4));
      border-color: rgba(244, 63, 94, 0.3);
    }

    .nav-btn-indigo {
      background: linear-gradient(135deg, #1e293b, #0f172a);
    }

    .nav-btn-indigo:hover {
      background: linear-gradient(135deg, rgba(79, 70, 229, 0.4), rgba(67, 56, 202, 0.4));
      border-color: rgba(99, 102, 241, 0.3);
    }

    .nav-btn-orange {
      background: linear-gradient(135deg, #1e293b, #0f172a);
    }

    .nav-btn-orange:hover {
      background: linear-gradient(135deg, rgba(234, 88, 12, 0.4), rgba(194, 65, 12, 0.4));
      border-color: rgba(249, 115, 22, 0.3);
    }

    .nav-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.3s ease;
    }

    .nav-btn:hover .nav-icon {
      transform: scale(1.1);
    }

    .nav-icon-badge {
      position: absolute;
      top: -4px;
      right: -4px;
      width: 20px;
      height: 20px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .nav-subtitle {
      font-size: 12px;
      color: #94a3b8;
      transition: color 0.3s ease;
    }

    .nav-btn:hover .nav-subtitle {
      color: inherit;
    }

    .quick-stats {
      margin-top: 48px;
      padding-top: 32px;
      border-top: 1px solid #334155;
    }

    .stat-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .stat-label {
      font-size: 14px;
      color: #cbd5e1;
    }

    .stat-value {
      font-weight: bold;
      font-size: 16px;
    }

    .main-content {
      flex: 1;
      padding: 32px;
      overflow-y: auto;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(1, 1fr);
      gap: 24px;
      margin-bottom: 48px;
    }

    @media (min-width: 768px) {
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (min-width: 1024px) {
      .stats-grid {
        grid-template-columns: repeat(4, 1fr);
      }
    }

    .stat-card {
      background: white;
      border-radius: 24px;
      padding: 24px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      border: 1px solid #e2e8f0;
      transition: box-shadow 0.3s ease;
    }

    .stat-card:hover {
      box-shadow: 0 30px 60px rgba(0, 0, 0, 0.15);
    }

    .stat-card-label {
      font-size: 14px;
      color: #64748b;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .stat-card-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .stat-card-icon.bg-blue {
      background: linear-gradient(135deg, #dbeafe, #bfdbfe);
    }

    .stat-card-icon.bg-emerald {
      background: linear-gradient(135deg, #d1fae5, #a7f3d0);
    }

    .stat-card-icon.bg-rose {
      background: linear-gradient(135deg, #fee2e2, #fecaca);
    }

    .stat-card-icon.bg-slate {
      background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
    }

    .stat-card-trend {
      margin-top: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      font-weight: 600;
    }

    .stat-card-trend.positive {
      color: #059669;
    }

    .stat-card-trend.warning {
      color: #d97706;
    }

    .form-container {
      background: white;
      border-radius: 32px;
      box-shadow: 0 30px 60px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      border: 1px solid #e2e8f0;
      margin-bottom: 48px;
    }

    .form-header {
      padding: 32px;
      color: white;
    }

    .form-header.bg-emerald {
      background: linear-gradient(135deg, #10b981, #059669);
    }

    .form-header.bg-rose {
      background: linear-gradient(135deg, #ef4444, #dc2626);
    }

    .form-header.bg-indigo {
      background: linear-gradient(135deg, #4f46e5, #3730a3);
    }

    .form-header.bg-orange {
      background: linear-gradient(135deg, #ea580c, #9a3412);
    }

    .form-header-icon {
      width: 64px;
      height: 64px;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .form-header-subtitle {
      color: rgba(255, 255, 255, 0.9);
      font-size: 14px;
    }

    .form-badge {
      padding: 8px 16px;
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      font-size: 14px;
      font-weight: 600;
    }

    .form-content {
      padding: 32px;
    }

    .form-group {
      margin-bottom: 24px;
    }

    .form-label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: #374151;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .form-label-icon {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .form-label-icon.bg-blue {
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    }

    .form-label-icon.bg-purple {
      background: linear-gradient(135deg, #8b5cf6, #7c3aed);
    }

    .form-label-icon.bg-amber {
      background: linear-gradient(135deg, #f59e0b, #d97706);
    }

    .form-label-icon.bg-emerald {
      background: linear-gradient(135deg, #10b981, #059669);
    }

    .form-label-icon.bg-cyan {
      background: linear-gradient(135deg, #06b6d4, #0891b2);
    }

    .form-label-icon.bg-slate {
      background: linear-gradient(135deg, #475569, #334155);
    }

    .form-label-icon.bg-rose {
      background: linear-gradient(135deg, #f43f5e, #e11d48);
    }

    .form-label-icon.bg-indigo {
      background: linear-gradient(135deg, #4f46e5, #3730a3);
    }

    .form-label-icon.bg-orange {
      background: linear-gradient(135deg, #ea580c, #9a3412);
    }

    .form-input {
      width: 100%;
      padding: 16px;
      border-radius: 16px;
      border: 2px solid #e2e8f0;
      font-size: 16px;
      transition: all 0.2s ease;
    }

    .form-input:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
      outline: none;
    }

    .form-help {
      font-size: 12px;
      color: #6b7280;
      margin-top: 4px;
    }

    .form-help-footer {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: #6b7280;
      margin-top: 4px;
    }

    .form-actions {
      margin-top: 48px;
      display: flex;
      flex-wrap: wrap;
      gap: 24px;
    }

    .btn-primary {
      padding: 16px 40px;
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      border-radius: 20px;
      font-size: 18px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 30px rgba(16, 185, 129, 0.3);
    }

    .btn-secondary {
      padding: 16px 32px;
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
      color: white;
      border-radius: 20px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s ease;
    }

    .btn-secondary:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 30px rgba(59, 130, 246, 0.3);
    }

    .btn-danger {
      padding: 16px 40px;
      background: linear-gradient(135deg, #ef4444, #dc2626);
      color: white;
      border-radius: 20px;
      font-size: 18px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s ease;
    }

    .btn-danger:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 30px rgba(239, 68, 68, 0.3);
    }

    .btn-dark {
      padding: 16px 32px;
      background: linear-gradient(135deg, #4b5563, #374151);
      color: white;
      border-radius: 20px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s ease;
    }

    .btn-dark:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 30px rgba(75, 85, 99, 0.3);
    }

    .btn-outline {
      padding: 16px 32px;
      background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
      color: #374151;
      border-radius: 20px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s ease;
    }

    .btn-outline:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
    }

    .btn-indigo {
      padding: 16px 40px;
      background: linear-gradient(135deg, #4f46e5, #3730a3);
      color: white;
      border-radius: 20px;
      font-size: 18px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s ease;
    }

    .btn-indigo:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 30px rgba(79, 70, 229, 0.3);
    }

    .btn-orange {
      padding: 16px 40px;
      background: linear-gradient(135deg, #ea580c, #9a3412);
      color: white;
      border-radius: 20px;
      font-size: 18px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s ease;
    }

    .btn-orange:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 30px rgba(234, 88, 12, 0.3);
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .modal-overlay.hidden {
      display: none;
    }

    .modal-backdrop {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(8px);
    }

    .modal-container {
      position: relative;
      width: 100%;
      max-width: 900px;
      max-height: 90vh;
      overflow: hidden;
      border-radius: 24px;
      background: white;
      animation: scaleIn 0.3s ease-out;
    }

    .modal-container-wide {
      position: relative;
      width: 100%;
      max-width: 1200px;
      max-height: 90vh;
      overflow-y: auto;
      border-radius: 24px;
      background: white;
      animation: scaleIn 0.3s ease-out;
    }

    .modal-content {
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .modal-content-surat {
      padding: 40px;
      background: white;
    }

    .modal-header {
      padding: 32px;
      color: white;
      flex-shrink: 0;
    }

    .modal-header-icon {
      width: 64px;
      height: 64px;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-header-subtitle {
      font-size: 14px;
      opacity: 0.9;
    }

    .modal-time {
      padding: 8px 16px;
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      font-size: 14px;
    }

    .modal-close-btn {
      width: 48px;
      height: 48px;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .modal-close-btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .status-bar {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin-top: 24px;
    }

    .status-item {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 16px;
      text-align: center;
    }

    .status-label {
      font-size: 12px;
      opacity: 0.9;
      margin-bottom: 4px;
    }

    .status-value {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-weight: bold;
      font-size: 14px;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }

    .modal-body {
      padding: 32px;
      overflow-y: auto;
      flex: 1;
    }

    .surat-container {
      font-family: 'Poppins', sans-serif;
      max-width: 210mm;
      margin: 0 auto;
      padding: 50px;
      background: white;
      border: 1px solid #ccc;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.15);
      page-break-inside: avoid;
      line-height: 1.6;
    }

    .surat-header {
      text-align: center;
      margin-bottom: 50px;
      padding-bottom: 30px;
      border-bottom: 3px solid #000;
    }

    .surat-title {
      font-size: 28px;
      font-weight: 800;
      margin-bottom: 15px;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #1f2937;
    }

    .surat-subtitle {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 25px;
      color: #374151;
    }

    .surat-info {
      font-size: 15px;
      line-height: 1.6;
      margin-bottom: 25px;
      color: #4b5563;
    }

    .surat-body {
      font-size: 15px;
      line-height: 1.8;
      margin-bottom: 40px;
      color: #1f2937;
    }

    .surat-table {
      width: 100%;
      border-collapse: collapse;
      margin: 25px 0;
      font-size: 14px;
    }

    .surat-table th {
      background-color: #f9fafb;
      color: #111827;
      font-weight: 700;
      text-align: left;
      padding: 15px;
      border: 1px solid #d1d5db;
    }

    .surat-table td {
      padding: 15px;
      border: 1px solid #d1d5db;
      color: #374151;
    }

    .surat-table tr:nth-child(even) {
      background-color: #f9fafb;
    }

    .surat-signature {
      display: flex;
      justify-content: space-between;
      margin-top: 100px;
    }

    .signature-box {
      width: 300px;
      text-align: center;
    }

    .signature-line {
      height: 2px;
      background: #000;
      margin: 60px 0 10px;
      width: 100%;
    }

    .signature-name {
      font-weight: 700;
      font-size: 16px;
      margin-top: 5px;
    }

    .signature-title {
      font-size: 14px;
      color: #4b5563;
    }

    .surat-footer {
      margin-top: 60px;
      padding-top: 30px;
      border-top: 2px solid #e5e7eb;
      font-size: 13px;
      color: #6b7280;
      text-align: center;
    }

    .popup-modal-container {
      position: relative;
      width: 95%;
      max-width: 1000px;
      background: white;
      border-radius: 32px;
      animation: scaleIn 0.4s ease-out;
      overflow: hidden;
      box-shadow: 0 40px 80px rgba(0, 0, 0, 0.3);
      margin: 20px;
    }

    .popup-header {
      padding: 40px;
      text-align: center;
      background: linear-gradient(135deg, #f8fafc, #f1f5f9);
      border-bottom: 2px solid #e2e8f0;
    }

    .popup-body {
      padding: 40px;
      text-align: center;
    }

    .popup-footer {
      padding: 30px 40px;
      background: #f8fafc;
      border-top: 2px solid #e2e8f0;
      text-align: center;
    }

    .popup-close-x {
      position: absolute;
      top: 25px;
      right: 25px;
      width: 50px;
      height: 50px;
      border-radius: 14px;
      background: rgba(0, 0, 0, 0.05);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 10;
    }

    .popup-close-x:hover {
      background: rgba(239, 68, 68, 0.1);
      transform: rotate(90deg);
    }

    .popup-close-x i {
      font-size: 26px;
      color: #64748b;
      transition: all 0.3s ease;
    }

    .popup-close-x:hover i {
      color: #ef4444;
      transform: scale(1.1);
    }

    .lock-animation-container {
      position: relative;
      width: 150px;
      height: 150px;
      margin: 0 auto 30px;
    }

    .lock-body {
      position: absolute;
      top: 50px;
      left: 40px;
      width: 70px;
      height: 60px;
      background: linear-gradient(135deg, #10b981, #059669);
      border-radius: 14px;
      box-shadow: 0 15px 40px rgba(16, 185, 129, 0.4);
      animation: lockFloat 3s ease-in-out infinite;
    }

    .lock-shackle {
      position: absolute;
      top: 0;
      left: 25px;
      width: 25px;
      height: 60px;
      background: linear-gradient(135deg, #0ea5e9, #2563eb);
      border-radius: 25px 25px 0 0;
      animation: lockFloat 3s ease-in-out infinite reverse;
    }

    .lock-keyhole {
      position: absolute;
      top: 70px;
      left: 50%;
      transform: translateX(-50%);
      width: 10px;
      height: 15px;
      background: #ffffff;
      border-radius: 5px;
    }

    .lock-shimmer {
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      animation: shimmer 2.5s ease-in-out infinite;
    }

    .error-x-animation {
      width: 120px;
      height: 120px;
      margin: 0 auto 30px;
      position: relative;
    }

    .error-x-line {
      position: absolute;
      border-radius: 5px;
    }

    .error-x-line-1 {
      top: 50%;
      left: 10%;
      width: 80%;
      height: 10px;
      transform: translateY(-50%) rotate(45deg);
      background: linear-gradient(135deg, #ef4444, #dc2626);
      animation: xRotate 0.6s ease-out;
      box-shadow: 0 5px 20px rgba(239, 68, 68, 0.3);
    }

    .error-x-line-2 {
      top: 50%;
      left: 10%;
      width: 80%;
      height: 10px;
      transform: translateY(-50%) rotate(-45deg);
      background: linear-gradient(135deg, #dc2626, #b91c1c);
      animation: xRotate 0.6s ease-out 0.1s backwards;
      box-shadow: 0 5px 20px rgba(239, 68, 68, 0.3);
    }

    .error-glow {
      position: absolute;
      width: 140px;
      height: 140px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(239, 68, 68, 0.25), transparent 70%);
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      animation: pulseGlow 2s ease-in-out infinite;
    }

    .red-text {
      color: #ef4444;
      font-weight: 700;
      background: rgba(239, 68, 68, 0.08);
      padding: 16px 24px;
      border-radius: 12px;
      border-left: 6px solid #ef4444;
      margin: 20px 0;
      text-align: left;
      font-size: 15px;
      line-height: 1.6;
    }

    .default-note {
      background: #f8fafc;
      padding: 20px;
      border-radius: 16px;
      border: 2px dashed #cbd5e1;
      margin-top: 20px;
      color: #475569;
      font-size: 15px;
      line-height: 1.6;
    }

    .data-display-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
      margin: 30px 0;
    }

    .data-card {
      background: white;
      border-radius: 20px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
      border: 2px solid #e2e8f0;
      transition: all 0.3s ease;
    }

    .data-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
    }

    .data-card.rejected {
      border-color: #fecaca;
      background: linear-gradient(to bottom right, #fef2f2, #fee2e2);
    }

    .data-card.available {
      border-color: #a7f3d0;
      background: linear-gradient(to bottom right, #f0fdf4, #dcfce7);
    }

    .data-card-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
    }

    .data-card-icon {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
    }

    .data-card-icon.rejected {
      background: linear-gradient(135deg, #ef4444, #dc2626);
      color: white;
    }

    .data-card-icon.available {
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
    }

    .data-card-title {
      font-size: 18px;
      font-weight: 700;
      color: #1f2937;
    }

    .data-card-subtitle {
      font-size: 13px;
      color: #6b7280;
    }

    .data-card-content {
      font-size: 16px;
      font-weight: 600;
      color: #374151;
      padding: 15px;
      background: rgba(255, 255, 255, 0.7);
      border-radius: 12px;
      border: 1px solid #e5e7eb;
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 700;
      margin-top: 15px;
    }

    .status-badge.rejected {
      background: rgba(239, 68, 68, 0.1);
      color: #dc2626;
    }

    .status-badge.available {
      background: rgba(16, 185, 129, 0.1);
      color: #059669;
    }

    @media (max-width: 1024px) {
      .sidebar {
        width: 240px;
        padding: 24px;
      }
      
      .main-content {
        padding: 24px;
      }
      
      .modal-container,
      .modal-container-wide {
        max-width: 95%;
      }

      .popup-modal-container {
        max-width: 95%;
        margin: 15px;
      }
    }

    @media (max-width: 768px) {
      .flex {
        flex-direction: column;
      }
      
      .sidebar {
        width: 100%;
        height: auto;
        position: relative;
      }
      
      .main-content {
        padding: 20px;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      .form-actions {
        flex-direction: column;
      }
      
      .status-bar {
        grid-template-columns: 1fr;
      }
      
      .modal-body {
        padding: 20px;
      }

      .popup-modal-container {
        margin: 10px;
        border-radius: 24px;
      }

      .popup-header,
      .popup-body,
      .popup-footer {
        padding: 25px;
      }

      .data-display-grid {
        grid-template-columns: 1fr;
      }

      .surat-container {
        padding: 25px;
      }

      .surat-signature {
        flex-direction: column;
        gap: 40px;
        align-items: center;
      }
    }

    @media print {
      .sidebar,
      .form-actions,
      .modal-close-btn,
      .btn-primary,
      .btn-secondary,
      .btn-danger,
      .btn-dark,
      .btn-outline {
        display: none !important;
      }
      
      .surat-container {
        box-shadow: none;
        border: none;
        padding: 0;
        margin: 0;
        width: 100%;
        max-width: none;
      }
      
      body {
        background: white;
        color: black;
      }
      
      .main-content {
        padding: 0;
      }
    }

    .hidden {
      display: none !important;
    }
    
    .text-indigo-400 { color: #818cf8; }
    .text-orange-400 { color: #fb923c; }
  </style>
</head>

<body class="bg-gradient-to-br from-slate-50 to-blue-50 font-sans text-slate-800 min-h-screen">
  
  <!-- Notification System -->
  <div class="notification-system" id="notificationSystem"></div>

  <!-- Main Container -->
  <div class="flex min-h-screen">
    
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="mb-12">
        <div class="flex items-center gap-4 mb-8">
          <div class="logo-icon">
            <i class="ri-shield-star-line text-white text-xl"></i>
          </div>
          <div>
            <h1 class="text-2xl font-bold">Asiang Panel</h1>
            <p class="text-slate-400 text-sm">Sistem Management Nasabah</p>
          </div>
        </div>
        
        <div class="glass-card rounded-xl p-4 mb-8">
          <div class="flex items-center justify-between mb-3">
            <span class="text-sm text-slate-400">Status Sistem</span>
            <div class="flex items-center gap-2">
              <div class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></div>
              <span class="text-sm font-semibold text-emerald-400">Online</span>
            </div>
          </div>
          <div class="flex items-center justify-between">
            <span class="text-sm text-slate-400">Waktu Server</span>
            <span id="systemClock" class="font-mono font-bold">--:--:--</span>
          </div>
        </div>
      </div>
      
      <nav class="space-y-3">
        <h3 class="text-xs uppercase tracking-wider text-slate-500 font-bold mb-6">Menu Utama</h3>
        
        <!-- Penguncian Paket Button -->
        <button id="navLock" class="nav-btn nav-btn-primary">
          <div class="relative">
            <div class="nav-icon bg-gradient-to-br from-emerald-600 to-emerald-800">
              <i class="ri-lock-line text-white text-lg"></i>
            </div>
            <div class="nav-icon-badge bg-emerald-500">
              <i class="ri-check-line text-xs text-white"></i>
            </div>
          </div>
          <div class="flex-1">
            <p class="font-semibold text-white">Penguncian Paket</p>
            <p class="nav-subtitle">Input data nasabah</p>
          </div>
          <i class="ri-arrow-right-s-line text-slate-500 group-hover:text-emerald-400 text-xl transition-all"></i>
        </button>
        
        <!-- Garansi Ditolak Button -->
        <button id="navReject" class="nav-btn nav-btn-danger">
          <div class="relative">
            <div class="nav-icon bg-gradient-to-br from-rose-600 to-rose-800">
              <i class="ri-close-circle-line text-white text-lg"></i>
            </div>
            <div class="nav-icon-badge bg-rose-500">
              <i class="ri-close-line text-xs text-white"></i>
            </div>
          </div>
          <div class="flex-1">
            <p class="font-semibold text-white">Garansi Ditolak</p>
            <p class="nav-subtitle">Status penolakan</p>
          </div>
          <i class="ri-arrow-right-s-line text-slate-500 group-hover:text-rose-400 text-xl transition-all"></i>
        </button>
        
        <!-- Pengajuan Pinjaman Button -->
        <button id="navLoan" class="nav-btn nav-btn-indigo">
          <div class="relative">
            <div class="nav-icon bg-gradient-to-br from-indigo-600 to-indigo-800">
              <i class="ri-bank-card-line text-white text-lg"></i>
            </div>
            <div class="nav-icon-badge bg-indigo-500">
              <i class="ri-file-line text-xs text-white"></i>
            </div>
          </div>
          <div class="flex-1">
            <p class="font-semibold text-white">Pengajuan Pinjaman</p>
            <p class="nav-subtitle">Surat pernyataan pinjaman</p>
          </div>
          <i class="ri-arrow-right-s-line text-slate-500 group-hover:text-indigo-400 text-xl transition-all"></i>
        </button>
        
        <!-- Perjanjian Penarikan Button -->
        <button id="navWithdrawal" class="nav-btn nav-btn-orange">
          <div class="relative">
            <div class="nav-icon bg-gradient-to-br from-orange-600 to-orange-800">
              <i class="ri-hand-coin-line text-white text-lg"></i>
            </div>
            <div class="nav-icon-badge bg-orange-500">
              <i class="ri-contract-line text-xs text-white"></i>
            </div>
          </div>
          <div class="flex-1">
            <p class="font-semibold text-white">Perjanjian Penarikan</p>
            <p class="nav-subtitle">Surat kontrak penarikan dana</p>
          </div>
          <i class="ri-arrow-right-s-line text-slate-500 group-hover:text-orange-400 text-xl transition-all"></i>
        </button>
      </nav>
      
      <!-- Quick Stats -->
      <div class="quick-stats">
        <h3 class="text-xs uppercase tracking-wider text-slate-500 font-bold mb-4">Statistik Cepat</h3>
        <div class="space-y-3">
          <div class="stat-item">
            <span class="stat-label">Paket Terkunci</span>
            <span class="stat-value text-emerald-400">896</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Garansi Ditolak</span>
            <span class="stat-value text-rose-400">214</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Total Nasabah</span>
            <span class="stat-value">1,842</span>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      
      <!-- Header -->
      <div class="mb-10 animate-fade-in">
        <div class="flex items-center justify-between mb-6">
          <div>
            <h1 class="text-4xl font-bold text-slate-900 mb-2">Sistem Panel Nasabah Premium</h1>
            <p class="text-slate-600">Advanced customer management platform</p>
          </div>
          <div class="flex items-center gap-4">
            <div class="system-status">
              <i class="ri-shield-check-line"></i>
              Sistem Terproteksi
            </div>
            <div class="text-right">
              <p class="text-sm text-slate-500">Waktu Real-time</p>
              <p id="liveClock" class="font-mono font-bold text-2xl text-slate-800">--:--:--</p>
            </div>
          </div>
        </div>
        
        <!-- Stats Cards -->
        <div class="stats-grid">
          <div class="stat-card animate-scale-in">
            <div class="flex items-center justify-between">
              <div>
                <p class="stat-card-label">Total Nasabah</p>
                <h3 class="text-3xl font-bold text-slate-900">1,842</h3>
              </div>
              <div class="stat-card-icon bg-blue">
                <i class="ri-user-3-fill text-blue-600 text-xl"></i>
              </div>
            </div>
            <div class="stat-card-trend positive">
              <i class="ri-arrow-up-line text-emerald-500"></i>
              <span>+12% aktif</span>
            </div>
          </div>
          
          <div class="stat-card animate-scale-in" style="animation-delay: 0.1s">
            <div class="flex items-center justify-between">
              <div>
                <p class="stat-card-label">Paket Terkunci</p>
                <h3 class="text-3xl font-bold text-slate-900">896</h3>
              </div>
              <div class="stat-card-icon bg-emerald">
                <i class="ri-lock-fill text-emerald-600 text-xl"></i>
              </div>
            </div>
            <div class="stat-card-trend">
              <i class="ri-shield-check-line text-blue-500"></i>
              <span>Proteksi aktif</span>
            </div>
          </div>
          
          <div class="stat-card animate-scale-in" style="animation-delay: 0.2s">
            <div class="flex items-center justify-between">
              <div>
                <p class="stat-card-label">Garansi Ditolak</p>
                <h3 class="text-3xl font-bold text-slate-900">214</h3>
              </div>
              <div class="stat-card-icon bg-rose">
                <i class="ri-close-circle-fill text-rose-600 text-xl"></i>
              </div>
            </div>
            <div class="stat-card-trend warning">
              <i class="ri-alert-line text-amber-500"></i>
              <span>Perlu penyesuaian</span>
            </div>
          </div>
          
          <div class="stat-card animate-scale-in" style="animation-delay: 0.3s">
            <div class="flex items-center justify-between">
              <div>
                <p class="stat-card-label">Status Sistem</p>
                <h3 class="text-3xl font-bold text-emerald-600">100%</h3>
              </div>
              <div class="stat-card-icon bg-slate">
                <i class="ri-server-fill text-slate-600 text-xl"></i>
              </div>
            </div>
            <div class="stat-card-trend positive">
              <i class="ri-wifi-line text-emerald-500"></i>
              <span>Semua sistem operasional</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Form Penguncian Paket -->
      <section id="sectionLock" class="page-enter">
        <div class="form-container">
          <!-- Form Header -->
          <div class="form-header bg-emerald">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-4">
                <div class="form-header-icon">
                  <i class="ri-lock-2-line text-2xl"></i>
                </div>
                <div>
                  <h2 class="text-2xl font-bold">Penguncian Paket</h2>
                  <p class="form-header-subtitle">Input data nasabah untuk penguncian paket trading</p>
                </div>
              </div>
              <div class="flex items-center gap-3">
                <div class="form-badge">
                  <i class="ri-shield-star-line mr-2"></i>Form Terproteksi
                </div>
              </div>
            </div>
          </div>
          
          <!-- Form Content -->
          <div class="form-content">
            <div class="grid lg:grid-cols-2 gap-8">
              <!-- Left Column -->
              <div class="space-y-6">
                <!-- Email Nasabah -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-blue">
                      <i class="ri-mail-line text-white text-sm"></i>
                    </div>
                    <span>Email Nasabah <span class="text-rose-500">*</span></span>
                  </label>
                  <input 
                    type="email" 
                    id="lockEmail"
                    class="form-input"
                    placeholder="nasabah@domain.com"
                    required
                  >
                  <p class="form-help">Masukkan email nasabah yang terdaftar</p>
                </div>
                
                <!-- Jenis Paket -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-purple">
                      <i class="ri-package-line text-white text-sm"></i>
                    </div>
                    <span>Jenis Paket <span class="text-rose-500">*</span></span>
                  </label>
                  <select id="lockPaket" class="form-input">
                    <option value="">Pilih Jenis Paket</option>
                    <option>Paket Trading Pertama</option>
                    <option>Paket Trading Kedua</option>
                    <option>Paket Trading Ketiga</option>
                    <option>Paket Trading Keempat</option>
                    <option>Paket Trading Pagi</option>
                    <option>Paket Trading Siang</option>
                    <option>Paket Trading Sore</option>
                    <option>Paket Trading Exclusive</option>
                    <option>Extra Dividen Paket 1</option>
                    <option>Extra Dividen Paket 2</option>
                    <option>Extra Dividen Paket 3</option>
                    <option>Extra Dividen</option>
                    <option>Extra Dividen Penarikan</option>
                    <option>Paket Trading Promo</option>
                    <option>Paket Trading Perbaikan</option>
                    <option>Paket Trading Validasi</option>
                    <option>Paket Trading Express</option>
                    <option>Paket Trading VIP</option>
                  </select>
                </div>
                
                <!-- Tahapan Paket -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-amber">
                      <i class="ri-list-ordered text-white text-sm"></i>
                    </div>
                    <span>Tahapan Paket <span class="text-rose-500">*</span></span>
                  </label>
                  <select id="lockTahap" class="form-input">
                    <option value="">Pilih Tahapan</option>
                    <option>Paket 1</option>
                    <option>Paket 2</option>
                    <option>Paket 3</option>
                    <option>Paket 4</option>
                    <option>Paket 5</option>
                    <option>Penarikan</option>
                    <option>Akhir</option>
                  </select>
                </div>
              </div>
              
              <!-- Right Column -->
              <div class="space-y-6">
                <!-- Modal Trading -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-emerald">
                      <i class="ri-money-dollar-circle-line text-white text-sm"></i>
                    </div>
                    <span>Modal Trading (Rp) <span class="text-rose-500">*</span></span>
                  </label>
                  <div class="relative">
                    <input 
                      type="text" 
                      id="lockModal"
                      class="form-input pl-12"
                      placeholder="10.000.000"
                      oninput="formatCurrency(this)"
                    >
                    <div class="absolute left-4 top-4">
                      <span class="font-semibold text-slate-700">Rp</span>
                    </div>
                    <button 
                      type="button"
                      onclick="formatCurrency(document.getElementById('lockModal'))"
                      class="absolute right-4 top-4 text-primary hover:text-blue-700"
                      title="Format angka"
                    >
                      <i class="ri-refresh-line"></i>
                    </button>
                  </div>
                </div>
                
                <!-- Profit Persentase -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-cyan">
                      <i class="ri-line-chart-line text-white text-sm"></i>
                    </div>
                    <span>Profit (%) <span class="text-rose-500">*</span></span>
                  </label>
                  <div class="relative">
                    <input 
                      type="number" 
                      id="lockProfit"
                      class="form-input"
                      placeholder="15"
                      min="0"
                      max="100"
                      step="0.1"
                    >
                    <div class="absolute right-4 top-4">
                      <span class="font-semibold text-slate-700">%</span>
                    </div>
                  </div>
                </div>
                
                <!-- Hasil Perhitungan -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-slate">
                      <i class="ri-calculator-line text-white text-sm"></i>
                    </div>
                    <span>Hasil Perhitungan</span>
                  </label>
                  <div class="relative">
                    <input 
                      type="text" 
                      id="lockHasil"
                      class="form-input bg-slate-50 font-bold text-slate-900 pr-24"
                      readonly
                    >
                    <div class="absolute right-4 top-4 flex items-center gap-3">
                      <button 
                        id="btnCopyLock"
                        class="text-primary hover:text-blue-700"
                        title="Copy hasil"
                      >
                        <i class="ri-clipboard-line"></i>
                      </button>
                      <span class="font-semibold text-slate-700">IDR</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Catatan Manual -->
            <div class="mt-8">
              <label class="form-label">
                <div class="form-label-icon bg-slate">
                  <i class="ri-sticky-note-line text-white text-sm"></i>
                </div>
                <span>Catatan Manual (Opsional)</span>
              </label>
              <textarea 
                id="lockNote"
                rows="3" 
                class="form-input"
                placeholder="Tulis catatan khusus untuk nasabah..."
                maxlength="500"
              ></textarea>
              <div class="form-help-footer">
                <span>Catatan aktif dan akan ditampilkan di sistem</span>
                <span id="charCountLock">0/500</span>
              </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="form-actions">
              <button 
                id="btnProcessLock"
                class="btn-primary"
              >
                <i class="ri-lock-line"></i>
                Proses Penguncian Paket
                <i class="ri-arrow-right-line"></i>
              </button>
              
              <button 
                id="btnCalculate"
                class="btn-secondary"
              >
                <i class="ri-calculator-line"></i>
                Hitung Otomatis
              </button>
              
              <button 
                id="btnResetLock"
                class="btn-outline"
              >
                <i class="ri-refresh-line"></i>
                Reset Form
              </button>
            </div>
          </div>
        </div>
      </section>
      
      <!-- Form Garansi Ditolak -->
      <section id="sectionReject" class="page-enter hidden">
        <div class="form-container">
          <!-- Form Header -->
          <div class="form-header bg-rose">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-4">
                <div class="form-header-icon">
                  <i class="ri-shield-cross-line text-2xl"></i>
                </div>
                <div>
                  <h2 class="text-2xl font-bold">Garansi Ditolak</h2>
                  <p class="form-header-subtitle">Input data penolakan dan alternatif paket</p>
                </div>
              </div>
              <div class="flex items-center gap-3">
                <div class="form-badge">
                  <i class="ri-alert-line mr-2"></i>Review Diperlukan
                </div>
              </div>
            </div>
          </div>
          
          <!-- Form Content -->
          <div class="form-content">
            <div class="grid lg:grid-cols-2 gap-8">
              <!-- Left Column -->
              <div class="space-y-6">
                <!-- Email Nasabah -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-blue">
                      <i class="ri-mail-line text-white text-sm"></i>
                    </div>
                    <span>Email Nasabah <span class="text-rose-500">*</span></span>
                  </label>
                  <input 
                    type="email" 
                    id="rejectEmail"
                    class="form-input"
                    placeholder="nasabah@domain.com"
                    required
                  >
                  <p class="form-help">Email nasabah yang mengajukan garansi</p>
                </div>
                
                <!-- Paket yang Diajukan -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-rose">
                      <i class="ri-close-circle-line text-white text-sm"></i>
                    </div>
                    <span>Paket yang Diajukan <span class="text-rose-500">*</span></span>
                  </label>
                  <select id="rejectPaket" class="form-input">
                    <option value="">Pilih Paket Diajukan</option>
                    <option>Paket Trading Pertama</option>
                    <option>Paket Trading Kedua</option>
                    <option>Paket Trading Ketiga</option>
                    <option>Paket Trading Keempat</option>
                    <option>Paket Trading Pagi</option>
                    <option>Paket Trading Siang</option>
                    <option>Paket Trading Sore</option>
                    <option>Paket Trading Exclusive</option>
                    <option>Extra Dividen Paket 1</option>
                    <option>Extra Dividen Paket 2</option>
                    <option>Extra Dividen Paket 3</option>
                    <option>Extra Dividen</option>
                    <option>Extra Dividen Penarikan</option>
                    <option>Paket Trading Promo</option>
                    <option>Paket Trading Perbaikan</option>
                    <option>Paket Trading Validasi</option>
                    <option>Paket Trading Express</option>
                    <option>Paket Trading VIP</option>
                  </select>
                </div>
                
                <!-- Modal Diajukan -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-emerald">
                      <i class="ri-money-dollar-circle-line text-white text-sm"></i>
                    </div>
                    <span>Modal Diajukan (Rp) <span class="text-rose-500">*</span></span>
                  </label>
                  <div class="relative">
                    <input 
                      type="text" 
                      id="rejectModal"
                      class="form-input pl-12"
                      placeholder="10.000.000"
                      oninput="formatCurrency(this)"
                    >
                    <div class="absolute left-4 top-4">
                      <span class="font-semibold text-slate-700">Rp</span>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Right Column -->
              <div class="space-y-6">
                <!-- Paket Tersedia 1 -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-emerald">
                      <i class="ri-checkbox-circle-line text-white text-sm"></i>
                    </div>
                    <span>Paket Tersedia 1 <span class="text-rose-500">*</span></span>
                  </label>
                  <select id="rejectTahap1" class="form-input">
                    <option value="">Pilih Paket Tersedia</option>
                    <option>Paket 1</option>
                    <option>Paket 2</option>
                    <option>Paket 3</option>
                    <option>Paket 4</option>
                    <option>Paket 5</option>
                  </select>
                  <p class="form-help">Pilih paket tersedia yang masih tersedia dalam sistem</p>
                </div>
                
                <!-- Paket Tersedia 2 -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-emerald">
                      <i class="ri-checkbox-circle-line text-white text-sm"></i>
                    </div>
                    <span>Paket Tersedia 2 (Opsional)</span>
                  </label>
                  <select id="rejectTahap2" class="form-input">
                    <option value="">Pilih Paket Tersedia Lainnya</option>
                    <option>Paket 1</option>
                    <option>Paket 2</option>
                    <option>Paket 3</option>
                    <option>Paket 4</option>
                    <option>Paket 5</option>
                  </select>
                  <p class="form-help">Opsional: Pilih paket tersedia tambahan</p>
                </div>
                
                <!-- Paket Alternatif -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-cyan">
                      <i class="ri-arrow-right-circle-line text-white text-sm"></i>
                    </div>
                    <span>Paket Alternatif (Opsional)</span>
                  </label>
                  <select id="rejectAlt1" class="form-input">
                    <option value="">Pilih Paket Alternatif</option>
                    <option>Paket 1</option>
                    <option>Paket 2</option>
                    <option>Paket 3</option>
                    <option>Paket 4</option>
                    <option>Paket 5</option>
                  </select>
                  <p class="form-help">Opsional: Pilih paket alternatif rekomendasi</p>
                </div>
              </div>
            </div>
            
            <!-- Catatan Penolakan -->
            <div class="mt-8">
              <label class="form-label">
                <div class="form-label-icon bg-slate">
                  <i class="ri-alert-line text-white text-sm"></i>
                </div>
                <span>Catatan Penolakan (Opsional)</span>
              </label>
              <textarea 
                id="rejectNote"
                rows="3" 
                class="form-input"
                placeholder="Alasan penolakan dan rekomendasi..."
                maxlength="500"
              ></textarea>
              <div class="form-help-footer">
                <span>Catatan aktif dan akan dikirim ke nasabah</span>
                <span id="charCountReject">0/500</span>
              </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="form-actions">
              <button 
                id="btnProcessReject"
                class="btn-danger"
              >
                <i class="ri-close-circle-line"></i>
                Proses Garansi Ditolak
                <i class="ri-arrow-right-line"></i>
              </button>
              
              <button 
                id="btnPreviewReject"
                class="btn-dark"
              >
                <i class="ri-eye-line mr-2"></i>
                Preview Surat
              </button>
              
              <button 
                id="btnResetReject"
                class="btn-outline"
              >
                <i class="ri-refresh-line mr-2"></i>
                Reset Form
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- ===== FORM PENGAJUAN PINJAMAN ===== -->
      <section id="sectionLoan" class="page-enter hidden">
        <div class="form-container">
          <!-- Form Header -->
          <div class="form-header bg-indigo">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-4">
                <div class="form-header-icon">
                  <i class="ri-bank-card-line text-2xl"></i>
                </div>
                <div>
                  <h2 class="text-2xl font-bold">Pengajuan Pinjaman Nasabah</h2>
                  <p class="form-header-subtitle">Formulir pengajuan pinjaman dana resmi dengan verifikasi sistem</p>
                </div>
              </div>
              <div class="flex items-center gap-3">
                <div class="form-badge">
                  <i class="ri-file-paper-line mr-2"></i>Dokumen Legal
                </div>
              </div>
            </div>
          </div>
          
          <!-- Form Content -->
          <div class="form-content">
            <div class="grid lg:grid-cols-2 gap-8">
              <!-- Kolom Kiri -->
              <div class="space-y-6">
                <!-- Nama Lengkap -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-blue">
                      <i class="ri-user-line text-white text-sm"></i>
                    </div>
                    <span>Nama Lengkap <span class="text-rose-500">*</span></span>
                  </label>
                  <input 
                    type="text" 
                    id="loanNama"
                    class="form-input"
                    placeholder="Masukkan nama lengkap nasabah"
                    required
                  >
                  <p class="form-help">Nama lengkap sesuai KTP/identitas</p>
                </div>
                
                <!-- Alamat Lengkap -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-purple">
                      <i class="ri-home-4-line text-white text-sm"></i>
                    </div>
                    <span>Alamat Lengkap <span class="text-rose-500">*</span></span>
                  </label>
                  <textarea 
                    id="loanAlamat"
                    rows="3"
                    class="form-input"
                    placeholder="Masukkan alamat lengkap nasabah"
                    required
                  ></textarea>
                  <p class="form-help">Alamat domisili saat ini</p>
                </div>
                
                <!-- NIK -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-amber">
                      <i class="ri-id-card-line text-white text-sm"></i>
                    </div>
                    <span>NIK (16 Digit) <span class="text-rose-500">*</span></span>
                  </label>
                  <input 
                    type="text" 
                    id="loanNik"
                    class="form-input"
                    placeholder="Masukkan 16 digit NIK"
                    maxlength="16"
                    pattern="[0-9]{16}"
                    required
                  >
                  <p class="form-help">Nomor Induk Kependudukan 16 digit</p>
                </div>
              </div>
              
              <!-- Kolom Kanan -->
              <div class="space-y-6">
                <!-- Nama Akun Trading -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-emerald">
                      <i class="ri-trading-line text-white text-sm"></i>
                    </div>
                    <span>Nama Akun Trading <span class="text-rose-500">*</span></span>
                  </label>
                  <input 
                    type="text" 
                    id="loanAkun"
                    class="form-input"
                    placeholder="Masukkan nama akun trading"
                    required
                  >
                  <p class="form-help">Nama akun trading yang terdaftar</p>
                </div>
                
                <!-- Jumlah Pinjaman -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-cyan">
                      <i class="ri-money-dollar-circle-line text-white text-sm"></i>
                    </div>
                    <span>Jumlah Pinjaman (Rp) <span class="text-rose-500">*</span></span>
                  </label>
                  <div class="relative">
                    <input 
                      type="text" 
                      id="loanJumlah"
                      class="form-input pl-12"
                      placeholder="100.000.000"
                      oninput="formatCurrency(this)"
                      required
                    >
                    <div class="absolute left-4 top-4">
                      <span class="font-semibold text-slate-700">Rp</span>
                    </div>
                  </div>
                </div>
                
                <!-- Skema Pelunasan -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-slate">
                      <i class="ri-calendar-schedule-line text-white text-sm"></i>
                    </div>
                    <span>Skema Pelunasan <span class="text-rose-500">*</span></span>
                  </label>
                  <select id="loanSkema" class="form-input" required>
                    <option value="">Pilih Skema Pelunasan</option>
                    <option>Setelah 1 sesi trading</option>
                    <option>Setelah 3 sesi trading</option>
                    <option>Setelah 5 sesi trading</option>
                    <option>Setelah 7 sesi trading</option>
                    <option>Cicilan 30 hari</option>
                    <option>Cicilan 60 hari</option>
                    <option>Cicilan 90 hari</option>
                  </select>
                </div>
              </div>
            </div>
            
            <!-- Catatan Khusus -->
            <div class="mt-8">
              <label class="form-label">
                <div class="form-label-icon bg-slate">
                  <i class="ri-sticky-note-line text-white text-sm"></i>
                </div>
                <span>Catatan Khusus (Opsional)</span>
              </label>
              <textarea 
                id="loanCatatan"
                rows="3" 
                class="form-input"
                placeholder="Tulis catatan khusus untuk perjanjian pinjaman..."
                maxlength="500"
              ></textarea>
              <div class="form-help-footer">
                <span>Catatan akan dimasukkan dalam surat perjanjian</span>
                <span id="charCountLoan">0/500</span>
              </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="form-actions">
              <button 
                id="btnProcessLoan"
                class="btn-indigo"
              >
                <i class="ri-file-paper-line"></i>
                Buat Surat Pinjaman
                <i class="ri-arrow-right-line"></i>
              </button>
              
              <button 
                id="btnPreviewLoan"
                class="btn-secondary"
              >
                <i class="ri-eye-line mr-2"></i>
                Preview Surat
              </button>
              
              <button 
                id="btnResetLoan"
                class="btn-outline"
              >
                <i class="ri-refresh-line mr-2"></i>
                Reset Form
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- ===== FORM PERJANJIAN PENARIKAN DANA ===== -->
      <section id="sectionWithdrawal" class="page-enter hidden">
        <div class="form-container">
          <!-- Form Header -->
          <div class="form-header bg-orange">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-4">
                <div class="form-header-icon">
                  <i class="ri-hand-coin-line text-2xl"></i>
                </div>
                <div>
                  <h2 class="text-2xl font-bold">Perjanjian Penarikan Dana</h2>
                  <p class="form-header-subtitle">Formulir perjanjian resmi penarikan dana antara nasabah dan perusahaan</p>
                </div>
              </div>
              <div class="flex items-center gap-3">
                <div class="form-badge">
                  <i class="ri-contract-line mr-2"></i>Dokumen Kontrak
                </div>
              </div>
            </div>
          </div>
          
          <!-- Form Content -->
          <div class="form-content">
            <!-- Pihak Pertama (Nasabah) -->
            <div class="mb-8">
              <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center">
                  <i class="ri-user-line text-white text-sm"></i>
                </div>
                Pihak Pertama (Nasabah)
              </h3>
              <div class="grid lg:grid-cols-2 gap-6">
                <!-- Nama Lengkap -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-blue">
                      <i class="ri-user-line text-white text-sm"></i>
                    </div>
                    <span>Nama Lengkap <span class="text-rose-500">*</span></span>
                  </label>
                  <input 
                    type="text" 
                    id="withdrawalNama"
                    class="form-input"
                    placeholder="Masukkan nama lengkap nasabah"
                    required
                  >
                </div>
                
                <!-- Nama Akun Trading -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-emerald">
                      <i class="ri-trading-line text-white text-sm"></i>
                    </div>
                    <span>Nama Akun Trading <span class="text-rose-500">*</span></span>
                  </label>
                  <input 
                    type="text" 
                    id="withdrawalAkun"
                    class="form-input"
                    placeholder="Masukkan nama akun trading"
                    required
                  >
                </div>
              </div>
            </div>
            
            <!-- Pihak Kedua (Perusahaan) -->
            <div class="mb-8">
              <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-orange-500 to-orange-600 flex items-center justify-center">
                  <i class="ri-building-line text-white text-sm"></i>
                </div>
                Pihak Kedua (Perusahaan)
              </h3>
              <div class="grid lg:grid-cols-2 gap-6">
                <!-- Nama Perusahaan -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-orange">
                      <i class="ri-building-line text-white text-sm"></i>
                    </div>
                    <span>Nama Perusahaan <span class="text-rose-500">*</span></span>
                  </label>
                  <input 
                    type="text" 
                    id="withdrawalPerusahaan"
                    class="form-input"
                    value="NEEX CORPORATION"
                    required
                  >
                </div>
                
                <!-- Tanggal Surat -->
                <div class="form-group">
                  <label class="form-label">
                    <div class="form-label-icon bg-slate">
                      <i class="ri-calendar-line text-white text-sm"></i>
                    </div>
                    <span>Tanggal Surat <span class="text-rose-500">*</span></span>
                  </label>
                  <input 
                    type="text" 
                    id="withdrawalTanggal"
                    class="form-input"
                    value=""
                    required
                  >
                </div>
              </div>
            </div>
            
            <!-- Catatan Khusus -->
            <div class="mt-8">
              <label class="form-label">
                <div class="form-label-icon bg-slate">
                  <i class="ri-sticky-note-line text-white text-sm"></i>
                </div>
                <span>Catatan Khusus (Opsional)</span>
              </label>
              <textarea 
                id="withdrawalCatatan"
                rows="3" 
                class="form-input"
                placeholder="Tulis catatan khusus untuk perjanjian penarikan dana..."
                maxlength="500"
              ></textarea>
              <div class="form-help-footer">
                <span>Catatan akan dimasukkan dalam perjanjian</span>
                <span id="charCountWithdrawal">0/500</span>
              </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="form-actions">
              <button 
                id="btnProcessWithdrawal"
                class="btn-orange"
              >
                <i class="ri-contract-line"></i>
                Buat Perjanjian Penarikan
                <i class="ri-arrow-right-line"></i>
              </button>
              
              <button 
                id="btnPreviewWithdrawal"
                class="btn-secondary"
              >
                <i class="ri-eye-line mr-2"></i>
                Preview Surat
              </button>
              
              <button 
                id="btnResetWithdrawal"
                class="btn-outline"
              >
                <i class="ri-refresh-line mr-2"></i>
                Reset Form
              </button>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- ===== POPUP BARU: SURAT GARANSI DITOLAK (FIXED) ===== -->
  <div id="popupGaransiDitolak" class="modal-overlay hidden">
    <div class="modal-backdrop"></div>
    <div class="popup-modal-container">
      <div class="popup-close-x" onclick="System.closeModal('popupGaransiDitolak')">
        <i class="ri-close-line"></i>
      </div>
      
      <div class="popup-header">
        <div class="error-x-animation">
          <div class="error-x-line error-x-line-1"></div>
          <div class="error-x-line error-x-line-2"></div>
          <div class="error-glow"></div>
        </div>
        <h2 class="text-2xl font-bold text-slate-900 mb-2">Pengajuan Tidak Dapat Diproses</h2>
        <p class="text-slate-600">Permohonan pendaftaran Trading dan Surat Jaminan Ganti Rugi tidak dapat Diterbitkan.</p>
      </div>
      
      <div class="popup-body">
        <!-- Data Nasabah -->
        <div class="bg-slate-50 rounded-2xl p-6 mb-6">
          <h3 class="font-bold text-slate-900 mb-4 flex items-center gap-2">
            <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center">
              <i class="ri-user-line text-white text-sm"></i>
            </div>
            Data Nasabah
          </h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <p class="text-sm text-slate-500 mb-1">Email Nasabah</p>
              <p class="font-semibold text-slate-900" id="garansiEmail">-</p>
            </div>
            <div>
              <p class="text-sm text-slate-500 mb-1">Modal Diajukan</p>
              <p class="font-semibold text-slate-900" id="garansiModal">-</p>
            </div>
          </div>
        </div>
        
        <!-- Data Paket yang Diajukan -->
        <div class="data-display-grid">
          <!-- Paket yang Diajukan (Ditolak) -->
          <div class="data-card rejected">
            <div class="data-card-header">
              <div class="data-card-icon rejected">
                <i class="ri-close-circle-line"></i>
              </div>
              <div>
                <h4 class="data-card-title">Paket yang Diajukan</h4>
                <p class="data-card-subtitle">Tidak tersedia di sistem</p>
              </div>
            </div>
            <div class="data-card-content" id="garansiPaketDiajukan">
              -
            </div>
            <div class="status-badge rejected">
              <i class="ri-close-circle-fill"></i>
              Ditolak
            </div>
          </div>
          
          <!-- Paket Tersedia 1 -->
          <div class="data-card available">
            <div class="data-card-header">
              <div class="data-card-icon available">
                <i class="ri-checkbox-circle-line"></i>
              </div>
              <div>
                <h4 class="data-card-title">Paket Tersedia 1</h4>
                <p class="data-card-subtitle">Masih tersedia di sistem</p>
              </div>
            </div>
            <div class="data-card-content" id="garansiPaketTersedia1">
              -
            </div>
            <div class="status-badge available">
              <i class="ri-checkbox-circle-fill"></i>
              Tersedia
            </div>
          </div>
          
          <!-- Paket Tersedia 2 (Conditional) -->
          <div class="data-card available hidden" id="garansiPaketTersedia2Container">
            <div class="data-card-header">
              <div class="data-card-icon available">
                <i class="ri-checkbox-circle-line"></i>
              </div>
              <div>
                <h4 class="data-card-title">Paket Tersedia 2</h4>
                <p class="data-card-subtitle">Opsional tambahan</p>
              </div>
            </div>
            <div class="data-card-content" id="garansiPaketTersedia2">
              -
            </div>
            <div class="status-badge available">
              <i class="ri-checkbox-circle-fill"></i>
              Tersedia
            </div>
          </div>
          
          <!-- Paket Alternatif (Conditional) -->
          <div class="data-card available hidden" id="garansiPaketAlternatifContainer">
            <div class="data-card-header">
              <div class="data-card-icon available">
                <i class="ri-arrow-right-circle-line"></i>
              </div>
              <div>
                <h4 class="data-card-title">Paket Alternatif</h4>
                <p class="data-card-subtitle">Rekomendasi sistem</p>
              </div>
            </div>
            <div class="data-card-content" id="garansiPaketAlternatif">
              -
            </div>
            <div class="status-badge available">
              <i class="ri-lightbulb-fill"></i>
              Rekomendasi
            </div>
          </div>
        </div>
        
        <!-- Pesan Error -->
        <div class="red-text mb-4">
          Data yang Anda ajukan tidak memenuhi persyaratan atau pilihan paket yang didaftarkan saat ini tidak tersedia pada sistem.
        </div>
        
        <!-- Catatan -->
        <div class="default-note" id="garansiCatatan">
          Silahkan memilih paket yang masih tersedia dan lakukan deposit kekurangan agar proses Trading dan Penarikan bisa dilakukan segera.
        </div>
      </div>
      
      <div class="popup-footer">
        <button 
          onclick="System.closeModal('popupGaransiDitolak')"
          class="px-8 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl font-semibold flex items-center gap-3 mx-auto btn-glow hover:shadow-lg transition-all duration-300"
        >
          <i class="ri-check-line"></i>
          Saya Mengerti
        </button>
      </div>
    </div>
  </div>

  <!-- ===== POPUP BARU: PENGUNCIAN PAKET BERHASIL (FIXED) ===== -->
  <div id="popupPenguncianBerhasil" class="modal-overlay hidden">
    <div class="modal-backdrop"></div>
    <div class="popup-modal-container">
      <div class="popup-close-x" onclick="System.closeModal('popupPenguncianBerhasil')">
        <i class="ri-close-line"></i>
      </div>
      
      <div class="popup-header">
        <div class="lock-animation-container">
          <div class="lock-body">
            <div class="lock-keyhole"></div>
            <div class="lock-shimmer"></div>
          </div>
          <div class="lock-shackle"></div>
        </div>
        <h2 class="text-2xl font-bold text-slate-900 mb-2">Penguncian Paket Berhasil</h2>
        <p class="text-slate-600">Paket telah berhasil dikunci oleh sistem sesuai data yang dimasukkan. Silakan periksa ringkasan informasi di bawah ini.</p>
      </div>
      
      <div class="popup-body">
        <!-- Ringkasan Informasi -->
        <div class="data-display-grid">
          <!-- Email Nasabah -->
          <div class="data-card">
            <div class="data-card-header">
              <div class="data-card-icon" style="background: linear-gradient(135deg, #3b82f6, #1d4ed8);">
                <i class="ri-mail-line"></i>
              </div>
              <div>
                <h4 class="data-card-title">Email Nasabah</h4>
                <p class="data-card-subtitle">Identifikasi nasabah</p>
              </div>
            </div>
            <div class="data-card-content" id="popupEmail">
              -
            </div>
          </div>
          
          <!-- Jenis Paket -->
          <div class="data-card available">
            <div class="data-card-header">
              <div class="data-card-icon available">
                <i class="ri-package-line"></i>
              </div>
              <div>
                <h4 class="data-card-title">Jenis Paket</h4>
                <p class="data-card-subtitle">Paket yang dipilih</p>
              </div>
            </div>
            <div class="data-card-content" id="popupPaket">
              -
            </div>
            <div class="status-badge available">
              <i class="ri-checkbox-circle-fill"></i>
              Aktif
            </div>
          </div>
          
          <!-- Modal Trading -->
          <div class="data-card">
            <div class="data-card-header">
              <div class="data-card-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                <i class="ri-money-dollar-circle-line"></i>
              </div>
              <div>
                <h4 class="data-card-title">Modal Trading</h4>
                <p class="data-card-subtitle">Jumlah investasi</p>
              </div>
            </div>
            <div class="data-card-content" id="popupModal">
              -
            </div>
          </div>
          
          <!-- Tahapan -->
          <div class="data-card">
            <div class="data-card-header">
              <div class="data-card-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                <i class="ri-list-ordered"></i>
              </div>
              <div>
                <h4 class="data-card-title">Tahapan</h4>
                <p class="data-card-subtitle">Step investasi</p>
              </div>
            </div>
            <div class="data-card-content" id="popupTahap">
              -
            </div>
          </div>
        </div>
        
        <!-- Perhitungan Profit -->
        <div class="bg-emerald-50 rounded-2xl p-6 mt-6 mb-6 border-2 border-emerald-200">
          <h3 class="font-bold text-emerald-900 mb-4 flex items-center gap-2">
            <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-emerald-500 to-emerald-600 flex items-center justify-center">
              <i class="ri-calculator-line text-white text-sm"></i>
            </div>
            Perhitungan Profit
          </h3>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <p class="text-sm text-emerald-700 mb-1">Profit (%)</p>
              <p class="font-bold text-emerald-800 text-lg" id="popupProfit">-</p>
            </div>
            <div>
              <p class="text-sm text-emerald-700 mb-1">Total Hasil</p>
              <p class="font-bold text-emerald-800 text-lg" id="popupHasil">-</p>
            </div>
          </div>
        </div>
        
        <!-- Catatan -->
        <div class="default-note" id="penguncianCatatan">
          Silakan menghubungi CS INVESTASI untuk melanjutkan proses sesuai tahapan yang dipilih. Seluruh data nasabah telah tercatat dan dikunci oleh sistem.
        </div>
      </div>
      
      <div class="popup-footer">
        <button 
          onclick="System.closeModal('popupPenguncianBerhasil')"
          class="px-8 py-3 bg-gradient-to-r from-emerald-600 to-emerald-700 text-white rounded-xl font-semibold flex items-center gap-3 mx-auto btn-glow hover:shadow-lg transition-all duration-300"
        >
          <i class="ri-check-double-line"></i>
          Konfirmasi & Tutup
        </button>
      </div>
    </div>
  </div>

  <!-- Modal Surat Digital -->
  <div id="modalSurat" class="modal-overlay hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-container-wide">
      <div class="modal-content-surat">
        <!-- Content will be populated by JavaScript -->
      </div>
    </div>
  </div>

  <script>
    // ===== SYSTEM UTILITIES =====
    const System = {
      showNotification: function(title, message, type = 'info') {
        const notificationSystem = document.getElementById('notificationSystem');
        
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        
        const config = {
          success: { 
            icon: 'ri-checkbox-circle-fill text-emerald-500',
            titleColor: 'text-emerald-800'
          },
          error: { 
            icon: 'ri-close-circle-fill text-rose-500',
            titleColor: 'text-rose-800'
          },
          warning: { 
            icon: 'ri-alert-fill text-amber-500',
            titleColor: 'text-amber-800'
          },
          info: { 
            icon: 'ri-information-fill text-blue-500',
            titleColor: 'text-blue-800'
          }
        }[type];
        
        const currentTime = new Date().toLocaleTimeString('id-ID', {hour: '2-digit', minute:'2-digit'});
        
        notification.innerHTML = `
          <div class="flex items-start gap-4">
            <div class="flex-shrink-0">
              <i class="${config.icon} text-2xl"></i>
            </div>
            <div class="flex-1">
              <div class="flex justify-between items-start mb-2">
                <h4 class="font-bold ${config.titleColor}">${title}</h4>
                <button onclick="this.parentElement.parentElement.parentElement.remove()" class="text-slate-400 hover:text-slate-600">
                  <i class="ri-close-line"></i>
                </button>
              </div>
              <p class="text-slate-700 text-sm">${message}</p>
              <div class="mt-3 flex items-center justify-between">
                <span class="text-xs text-slate-500">${currentTime}</span>
                <div class="w-32 h-1 bg-slate-200 rounded-full overflow-hidden">
                  <div class="h-full ${type === 'success' ? 'bg-emerald-500' : type === 'error' ? 'bg-rose-500' : 'bg-blue-500'} animate-[shrink_5s_linear_forwards]"></div>
                </div>
              </div>
            </div>
          </div>
        `;
        
        notificationSystem.appendChild(notification);
        
        setTimeout(() => {
          if (notification.parentNode) {
            notification.style.animation = 'notificationHide 0.5s ease-out forwards';
            setTimeout(() => {
              if (notification.parentNode) {
                notification.remove();
              }
            }, 500);
          }
        }, 5000);
      },

      formatRupiah: function(angka) {
        if (!angka) return 'Rp 0';
        return 'Rp ' + angka.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.');
      },

      formatDate: function(date, includeTime = true) {
        const d = new Date(date);
        const options = { 
          day: '2-digit', 
          month: 'long', 
          year: 'numeric' 
        };
        
        if (includeTime) {
          return `${d.toLocaleDateString('id-ID', options)} ${d.toLocaleTimeString('id-ID', {hour: '2-digit', minute: '2-digit'})}`;
        }
        
        return d.toLocaleDateString('id-ID', options);
      },

      closeModal: function(modalId) {
        const modal = document.getElementById(modalId);
        modal.classList.add('hidden');
        this.showNotification('Modal Ditutup', 'Panel berhasil ditutup', 'info');
      },

      generateId: function(prefix = '') {
        return `${prefix}-${Date.now()}-${Math.random().toString(36).substr(2, 9).toUpperCase()}`;
      }
    };

    // ===== POPUP BARU FUNCTIONS (FIXED) =====
    const NewPopups = {
      showGaransiDitolak: function(data = {}) {
        const popup = document.getElementById('popupGaransiDitolak');
        
        // Isi data ke popup
        if (data.email) {
          document.getElementById('garansiEmail').textContent = data.email;
        }
        if (data.modal) {
          document.getElementById('garansiModal').textContent = data.modal;
        }
        if (data.paket) {
          document.getElementById('garansiPaketDiajukan').textContent = data.paket;
        }
        if (data.tahap1) {
          document.getElementById('garansiPaketTersedia1').textContent = data.tahap1;
        }
        
        // Tampilkan paket tersedia 2 jika ada
        if (data.tahap2 && data.tahap2.trim() !== '') {
          document.getElementById('garansiPaketTersedia2Container').classList.remove('hidden');
          document.getElementById('garansiPaketTersedia2').textContent = data.tahap2;
        } else {
          document.getElementById('garansiPaketTersedia2Container').classList.add('hidden');
        }
        
        // Tampilkan paket alternatif jika ada
        if (data.alt1 && data.alt1.trim() !== '') {
          document.getElementById('garansiPaketAlternatifContainer').classList.remove('hidden');
          document.getElementById('garansiPaketAlternatif').textContent = data.alt1;
        } else {
          document.getElementById('garansiPaketAlternatifContainer').classList.add('hidden');
        }
        
        // Catatan
        const catatanElement = document.getElementById('garansiCatatan');
        if (data.note && data.note.trim() !== '') {
          catatanElement.textContent = data.note;
        } else {
          catatanElement.textContent = 'Silahkan memilih paket yang masih tersedia dan lakukan deposit kekurangan agar proses Trading dan Penarikan bisa dilakukan segera.';
        }
        
        popup.classList.remove('hidden');
        System.showNotification('Garansi Ditolak', 'Pengajuan surat garansi tidak dapat diproses', 'error');
      },

      showPenguncianBerhasil: function(data = {}) {
        const popup = document.getElementById('popupPenguncianBerhasil');
        
        // Isi data ke popup
        if (data.email) {
          document.getElementById('popupEmail').textContent = data.email;
        }
        if (data.paket) {
          document.getElementById('popupPaket').textContent = data.paket;
        }
        if (data.modal) {
          document.getElementById('popupModal').textContent = data.modal;
        }
        if (data.tahap) {
          document.getElementById('popupTahap').textContent = data.tahap;
        }
        if (data.profit) {
          document.getElementById('popupProfit').textContent = data.profit;
        }
        if (data.hasil) {
          document.getElementById('popupHasil').textContent = data.hasil;
        }
        
        const catatanElement = document.getElementById('penguncianCatatan');
        if (data.note && data.note.trim() !== '') {
          catatanElement.textContent = data.note;
        } else {
          catatanElement.textContent = 'Silakan menghubungi CS INVESTASI untuk melanjutkan proses sesuai tahapan yang dipilih. Seluruh data nasabah telah tercatat dan dikunci oleh sistem.';
        }
        
        popup.classList.remove('hidden');
        System.showNotification('Paket Terkunci', 'Paket trading berhasil dikunci oleh sistem', 'success');
      }
    };

    // ===== MODALS MANAGEMENT (IMPROVED) =====
    const Modals = {
      showLoanAgreement: function(data) {
        const modal = document.getElementById('modalSurat');
        const currentDate = new Date().toLocaleDateString('id-ID', {
          day: '2-digit',
          month: 'long',
          year: 'numeric'
        });
        
        const modalContent = document.querySelector('#modalSurat .modal-content-surat');
        modalContent.innerHTML = this.generateLoanAgreementContent(data, currentDate);
        
        modal.classList.remove('hidden');
      },

      showWithdrawalAgreement: function(data) {
        const modal = document.getElementById('modalSurat');
        const currentDate = new Date().toLocaleDateString('id-ID', {
          day: '2-digit',
          month: 'long',
          year: 'numeric'
        });
        
        const modalContent = document.querySelector('#modalSurat .modal-content-surat');
        modalContent.innerHTML = this.generateWithdrawalAgreementContent(data, currentDate);
        
        modal.classList.remove('hidden');
      },

      generateLoanAgreementContent: function(data, currentDate) {
        return `
          <div class="surat-container">
            <!-- Kop Surat -->
            <div class="surat-header">
              <h1 class="surat-title">ASIANG TRADING SYSTEM</h1>
              <p class="surat-subtitle">Sistem Manajemen Trading Terintegrasi</p>
              <div class="surat-info">
                <p>Jl. Profesi No. 123, Jakarta 12560</p>
                <p>Email: admin@asiang.com | Telp: (021) 1234-5678</p>
              </div>
            </div>
            
            <!-- Nomor Surat -->
            <div class="text-center mb-8">
              <p class="font-bold text-lg">SURAT PERNYATAAN PINJAMAN</p>
              <p class="text-sm">No: ${data.id || 'PINJAMAN-' + Date.now()}</p>
              <p class="text-sm">Tanggal: ${currentDate}</p>
            </div>
            
            <!-- Isi Surat -->
            <div class="surat-body">
              <p>Yang bertanda tangan di bawah ini:</p>
              
              <table class="surat-table mt-4 mb-6">
                <tr>
                  <td width="30%"><strong>Nama Lengkap</strong></td>
                  <td width="70%">: ${data.nama}</td>
                </tr>
                <tr>
                  <td><strong>Alamat</strong></td>
                  <td>: ${data.alamat}</td>
                </tr>
                <tr>
                  <td><strong>NIK</strong></td>
                  <td>: ${data.nik}</td>
                </tr>
                <tr>
                  <td><strong>Akun Trading</strong></td>
                  <td>: ${data.akun}</td>
                </tr>
              </table>
              
              <p class="mt-6 mb-4">Dengan ini menyatakan:</p>
              
              <ol class="list-decimal pl-5 mb-6 space-y-2">
                <li>Mengajukan pinjaman dana sebesar <strong>${data.jumlah}</strong> kepada ASIANG TRADING SYSTEM.</li>
                <li>Pinjaman akan digunakan untuk kegiatan trading sesuai ketentuan perusahaan.</li>
                <li>Pelunasan pinjaman akan dilakukan dengan skema: <strong>${data.skema}</strong>.</li>
                <li>Bersedia mematuhi semua syarat dan ketentuan yang berlaku.</li>
                <li>Menyetujui bahwa perusahaan berhak melakukan pemotongan sesuai perjanjian.</li>
              </ol>
              
              ${data.catatan ? `
              <div class="mt-6 p-4 bg-gray-100 border border-gray-300 rounded">
                <p class="font-bold mb-2">Catatan Khusus:</p>
                <p>${data.catatan}</p>
              </div>
              ` : ''}
              
              <p class="mt-8">Demikian surat pernyataan ini dibuat dengan sebenar-benarnya tanpa paksaan dari pihak manapun.</p>
            </div>
            
            <!-- Tanda Tangan -->
            <div class="surat-signature">
              <div class="signature-box">
                <p>Hormat saya,</p>
                <div class="signature-line"></div>
                <p class="signature-name">${data.nama}</p>
                <p class="signature-title">Nasabah ASIANG Trading</p>
              </div>
              
              <div class="signature-box">
                <p>Menyetujui,</p>
                <div class="signature-line"></div>
                <p class="signature-name">Manajer Keuangan</p>
                <p class="signature-title">ASIANG TRADING SYSTEM</p>
              </div>
            </div>
            
            <div class="surat-footer">
              <p>Dokumen ini sah dan berlaku sebagai bukti perjanjian yang mengikat secara hukum.</p>
            </div>
          </div>
          
          <!-- Action Buttons -->
          <div class="flex justify-center gap-4 mt-8">
            <button 
              onclick="window.print()"
              class="px-6 py-3 bg-gradient-to-r from-emerald-600 to-emerald-700 text-white rounded-lg font-semibold flex items-center gap-3 btn-glow"
            >
              <i class="ri-printer-line"></i>
              Cetak Surat
            </button>
            
            <button 
              onclick="System.closeModal('modalSurat')"
              class="px-6 py-3 bg-gradient-to-r from-slate-600 to-slate-700 text-white rounded-lg font-semibold flex items-center gap-3"
            >
              <i class="ri-close-line"></i>
              Tutup
            </button>
          </div>
        `;
      },

      generateWithdrawalAgreementContent: function(data, currentDate) {
        return `
          <div class="surat-container">
            <!-- Kop Surat -->
            <div class="surat-header">
              <h1 class="surat-title">PERJANJIAN PENARIKAN DANA</h1>
              <p class="surat-subtitle">Antara Nasabah dan Perusahaan</p>
              <div class="surat-info">
                <p>No: ${data.id || 'PENARIKAN-' + Date.now()} | Tanggal: ${data.tanggal || currentDate}</p>
              </div>
            </div>
            
            <!-- Pihak-Pihak -->
            <div class="mt-8">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                  <h3 class="font-bold mb-4 text-lg">PIHAK PERTAMA</h3>
                  <table class="surat-table">
                    <tr>
                      <td width="40%"><strong>Nama</strong></td>
                      <td>: ${data.nama}</td>
                    </tr>
                    <tr>
                      <td><strong>Akun Trading</strong></td>
                      <td>: ${data.akun}</td>
                    </tr>
                    <tr>
                      <td><strong>Status</strong></td>
                      <td>: Nasabah ASIANG Trading</td>
                    </tr>
                  </table>
                </div>
                
                <div>
                  <h3 class="font-bold mb-4 text-lg">PIHAK KEDUA</h3>
                  <table class="surat-table">
                    <tr>
                      <td width="40%"><strong>Nama Perusahaan</strong></td>
                      <td>: ${data.perusahaan}</td>
                    </tr>
                    <tr>
                      <td><strong>Alamat</strong></td>
                      <td>: Jl. Profesi No. 123, Jakarta</td>
                    </tr>
                    <tr>
                      <td><strong>Status</strong></td>
                      <td>: Penyelenggara Trading</td>
                    </tr>
                  </table>
                </div>
              </div>
            </div>
            
            <!-- Isi Perjanjian -->
            <div class="surat-body mt-8">
              <p class="mb-6">Para pihak di atas dengan ini sepakat membuat perjanjian penarikan dana dengan ketentuan sebagai berikut:</p>
              
              <div class="mb-6">
                <h4 class="font-bold mb-2 text-lg">PASAL 1 - TUJUAN PERJANJIAN</h4>
                <p>Perjanjian ini dibuat untuk mengatur proses penarikan dana dari akun trading milik Pihak Pertama yang dikelola oleh Pihak Kedua.</p>
              </div>
              
              <div class="mb-6">
                <h4 class="font-bold mb-2 text-lg">PASAL 2 - HAK DAN KEWAJIBAN</h4>
                <ol class="list-decimal pl-5 space-y-2">
                  <li>Pihak Pertama berhak menarik dana sesuai saldo yang tersedia.</li>
                  <li>Pihak Kedua wajib memproses penarikan dalam waktu 1x24 jam kerja.</li>
                  <li>Biaya administrasi penarikan mengikuti ketentuan yang berlaku.</li>
                  <li>Penarikan hanya dapat dilakukan pada hari kerja.</li>
                </ol>
              </div>
              
              <div class="mb-6">
                <h4 class="font-bold mb-2 text-lg">PASAL 3 - PROSEDUR PENARIKAN</h4>
                <ol class="list-decimal pl-5 space-y-2">
                  <li>Pengajuan penarikan melalui sistem ASIANG Trading.</li>
                  <li>Verifikasi data oleh customer service.</li>
                  <li>Proses pencairan oleh finance department.</li>
                  <li>Konfirmasi selesai kepada nasabah.</li>
                </ol>
              </div>
              
              ${data.catatan ? `
              <div class="mb-6">
                <h4 class="font-bold mb-2 text-lg">PASAL 4 - KETENTUAN KHUSUS</h4>
                <p>${data.catatan}</p>
              </div>
              ` : ''}
              
              <div class="mb-6">
                <h4 class="font-bold mb-2 text-lg">PASAL 5 - PENUTUP</h4>
                <p>Perjanjian ini berlaku sejak ditandatangani dan dapat direvisi dengan persetujuan kedua belah pihak.</p>
              </div>
              
              <p class="mt-8">Demikian perjanjian ini dibuat dalam keadaan sadar dan tanpa paksaan.</p>
            </div>
            
            <!-- Tanda Tangan -->
            <div class="surat-signature">
              <div class="signature-box">
                <p>PIHAK PERTAMA</p>
                <div class="signature-line"></div>
                <p class="signature-name">${data.nama}</p>
                <p class="signature-title">Nasabah ASIANG Trading</p>
              </div>
              
              <div class="signature-box">
                <p>PIHAK KEDUA</p>
                <div class="signature-line"></div>
                <p class="signature-name">${data.perusahaan}</p>
                <p class="signature-title">Perusahaan Penyelenggara</p>
              </div>
            </div>
            
            <div class="surat-footer">
              <p>Perjanjian ini dibuat rangkap 2 (dua) bermaterai cukup dan mempunyai kekuatan hukum yang sama.</p>
            </div>
          </div>
          
          <!-- Action Buttons -->
          <div class="flex justify-center gap-4 mt-8">
            <button 
              onclick="window.print()"
              class="px-6 py-3 bg-gradient-to-r from-emerald-600 to-emerald-700 text-white rounded-lg font-semibold flex items-center gap-3 btn-glow"
            >
              <i class="ri-printer-line"></i>
              Cetak Perjanjian
            </button>
            
            <button 
              onclick="System.closeModal('modalSurat')"
              class="px-6 py-3 bg-gradient-to-r from-slate-600 to-slate-700 text-white rounded-lg font-semibold flex items-center gap-3"
            >
              <i class="ri-close-line"></i>
              Tutup
            </button>
          </div>
        `;
      }
    };

    // ===== MAIN APPLICATION LOGIC (FIXED) =====
    class AsiApp {
      constructor() {
        this.currentForm = 'lock';
        this.formData = {
          lock: {},
          reject: {},
          loan: {},
          withdrawal: {}
        };
        this.init();
      }

      init() {
        this.setupEventListeners();
        this.updateClocks();
        this.loadSavedData();
        this.setupInitialData();
        System.showNotification('Sistem Siap', 'ASIANG Banking System siap digunakan', 'success');
      }

      setupEventListeners() {
        // Navigation
        document.getElementById('navLock').addEventListener('click', () => this.showSection('sectionLock'));
        document.getElementById('navReject').addEventListener('click', () => this.showSection('sectionReject'));
        document.getElementById('navLoan').addEventListener('click', () => this.showSection('sectionLoan'));
        document.getElementById('navWithdrawal').addEventListener('click', () => this.showSection('sectionWithdrawal'));

        // Lock Form
        document.getElementById('btnProcessLock').addEventListener('click', (e) => {
          e.preventDefault();
          this.processLockForm();
        });
        document.getElementById('btnCalculate').addEventListener('click', () => this.calculateLockResult());
        document.getElementById('btnResetLock').addEventListener('click', () => this.resetForm('lock'));
        document.getElementById('btnCopyLock').addEventListener('click', () => this.copyResult());

        // Reject Form
        document.getElementById('btnProcessReject').addEventListener('click', (e) => {
          e.preventDefault();
          this.processRejectForm();
        });
        document.getElementById('btnPreviewReject').addEventListener('click', (e) => {
          e.preventDefault();
          this.previewRejectForm();
        });
        document.getElementById('btnResetReject').addEventListener('click', () => this.resetForm('reject'));

        // Loan Form
        document.getElementById('btnProcessLoan').addEventListener('click', (e) => {
          e.preventDefault();
          this.processLoanForm();
        });
        document.getElementById('btnPreviewLoan').addEventListener('click', (e) => {
          e.preventDefault();
          this.previewLoanForm();
        });
        document.getElementById('btnResetLoan').addEventListener('click', () => this.resetForm('loan'));

        // Withdrawal Form
        document.getElementById('btnProcessWithdrawal').addEventListener('click', (e) => {
          e.preventDefault();
          this.processWithdrawalForm();
        });
        document.getElementById('btnPreviewWithdrawal').addEventListener('click', (e) => {
          e.preventDefault();
          this.previewWithdrawalForm();
        });
        document.getElementById('btnResetWithdrawal').addEventListener('click', () => this.resetForm('withdrawal'));

        // Input Listeners
        document.getElementById('lockProfit').addEventListener('input', () => this.calculateLockResult());
        document.getElementById('lockModal').addEventListener('input', () => this.calculateLockResult());
        document.getElementById('lockNote').addEventListener('input', () => this.updateCharCount('lock'));
        document.getElementById('rejectNote').addEventListener('input', () => this.updateCharCount('reject'));
        document.getElementById('loanCatatan').addEventListener('input', () => this.updateCharCount('loan'));
        document.getElementById('withdrawalCatatan').addEventListener('input', () => this.updateCharCount('withdrawal'));

        // Close modals when clicking outside
        document.querySelectorAll('.modal-overlay').forEach(modal => {
          modal.addEventListener('click', function(e) {
            if (e.target === this) {
              this.classList.add('hidden');
            }
          });
        });
      }

      setupInitialData() {
        // Set tanggal otomatis untuk withdrawal
        const now = new Date();
        const options = { day: '2-digit', month: 'long', year: 'numeric' };
        document.getElementById('withdrawalTanggal').value = `Jakarta, ${now.toLocaleDateString('id-ID', options)}`;
      }

      showSection(sectionId) {
        // Hide all sections
        document.querySelectorAll('.page-enter').forEach(section => {
          section.classList.add('hidden');
        });
        
        // Show selected section
        const section = document.getElementById(sectionId);
        section.classList.remove('hidden');
        section.classList.add('page-enter');
        
        // Update current form
        this.currentForm = sectionId.replace('section', '').toLowerCase();
        
        // Show notification
        const title = this.getSectionTitle(sectionId);
        const message = `Berhasil beralih ke ${title}`;
        
        System.showNotification(`Sistem ${title}`, message, 'info');
      }

      getSectionTitle(sectionId) {
        const titles = {
          'sectionLock': 'Penguncian Paket',
          'sectionReject': 'Garansi Ditolak',
          'sectionLoan': 'Pengajuan Pinjaman',
          'sectionWithdrawal': 'Perjanjian Penarikan'
        };
        return titles[sectionId] || 'Form';
      }

      updateClocks() {
        const update = () => {
          const now = new Date();
          const time = now.toLocaleTimeString('id-ID', { 
            hour12: false,
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit'
          });
          
          document.getElementById('systemClock').textContent = time;
          document.getElementById('liveClock').textContent = time;
        };
        
        update();
        setInterval(update, 1000);
      }

      calculateLockResult() {
        const modal = parseFloat(document.getElementById('lockModal').value.replace(/\./g, '')) || 0;
        const profit = parseFloat(document.getElementById('lockProfit').value) || 0;
        const hasil = modal + (modal * profit / 100);
        
        document.getElementById('lockHasil').value = System.formatRupiah(hasil);
        return hasil;
      }

      updateCharCount(type) {
        const textarea = document.getElementById(`${type}${type === 'lock' ? 'Note' : type === 'reject' ? 'Note' : 'Catatan'}`);
        const counter = document.getElementById(`charCount${type.charAt(0).toUpperCase() + type.slice(1)}`);
        
        if (textarea && counter) {
          counter.textContent = `${textarea.value.length}/500`;
        }
      }

      validateEmail(email) {
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return re.test(email);
      }

      async processLockForm() {
        if (!this.validateLockForm()) {
          System.showNotification('Validasi Gagal', 'Harap lengkapi semua field yang wajib diisi', 'error');
          return;
        }

        const formData = {
          email: document.getElementById('lockEmail').value.trim(),
          paket: document.getElementById('lockPaket').value,
          tahap: document.getElementById('lockTahap').value,
          modal: document.getElementById('lockModal').value,
          profit: document.getElementById('lockProfit').value + '%',
          hasil: document.getElementById('lockHasil').value,
          note: document.getElementById('lockNote').value.trim(),
          timestamp: new Date().toISOString(),
          id: `LOCK-${Date.now()}-${Math.random().toString(36).substr(2, 4).toUpperCase()}`
        };

        this.saveToStorage('lock', formData);
        
        await new Promise(resolve => setTimeout(resolve, 100));
        
        // Tampilkan popup baru untuk penguncian paket
        NewPopups.showPenguncianBerhasil(formData);
        
        System.showNotification('Penguncian Berhasil', 'Paket trading berhasil dikunci oleh sistem', 'success');
      }

      validateLockForm() {
        const requiredFields = [
          'lockEmail',
          'lockPaket', 
          'lockTahap',
          'lockModal',
          'lockProfit'
        ];

        let isValid = true;

        requiredFields.forEach(fieldId => {
          const field = document.getElementById(fieldId);
          const value = field.value.trim();
          
          if (!value) {
            field.classList.add('border-rose-500', 'ring-2', 'ring-rose-200');
            setTimeout(() => {
              field.classList.remove('border-rose-500', 'ring-2', 'ring-rose-200');
            }, 3000);
            isValid = false;
          }
        });

        if (!this.validateEmail(document.getElementById('lockEmail').value)) {
          System.showNotification('Email Tidak Valid', 'Format email tidak sesuai', 'error');
          isValid = false;
        }

        return isValid;
      }

      async processRejectForm() {
        if (!this.validateRejectForm()) {
          System.showNotification('Validasi Gagal', 'Harap lengkapi semua field yang wajib diisi', 'error');
          return;
        }

        const formData = {
          email: document.getElementById('rejectEmail').value.trim(),
          paket: document.getElementById('rejectPaket').value,
          modal: document.getElementById('rejectModal').value,
          tahap1: document.getElementById('rejectTahap1').value,
          tahap2: document.getElementById('rejectTahap2').value,
          alt1: document.getElementById('rejectAlt1').value,
          note: document.getElementById('rejectNote').value.trim(),
          timestamp: new Date().toISOString(),
          id: `REJECT-${Date.now()}-${Math.random().toString(36).substr(2, 4).toUpperCase()}`
        };

        this.saveToStorage('reject', formData);
        
        await new Promise(resolve => setTimeout(resolve, 100));
        
        // Tampilkan popup baru untuk garansi ditolak
        NewPopups.showGaransiDitolak(formData);
        
        System.showNotification('Proses Selesai', 'Data garansi ditolak berhasil diproses', 'warning');
      }

      validateRejectForm() {
        const requiredFields = [
          'rejectEmail',
          'rejectPaket',
          'rejectModal',
          'rejectTahap1'
        ];

        let isValid = true;

        requiredFields.forEach(fieldId => {
          const field = document.getElementById(fieldId);
          const value = field.value.trim();
          
          if (!value) {
            field.classList.add('border-rose-500', 'ring-2', 'ring-rose-200');
            setTimeout(() => {
              field.classList.remove('border-rose-500', 'ring-2', 'ring-rose-200');
            }, 3000);
            isValid = false;
          }
        });

        if (!this.validateEmail(document.getElementById('rejectEmail').value)) {
          System.showNotification('Email Tidak Valid', 'Format email tidak sesuai', 'error');
          isValid = false;
        }

        return isValid;
      }

      previewRejectForm() {
        if (!this.validateRejectForm()) {
          System.showNotification('Validasi Gagal', 'Harap lengkapi semua field yang wajib diisi', 'error');
          return;
        }

        const formData = {
          email: document.getElementById('rejectEmail').value.trim(),
          paket: document.getElementById('rejectPaket').value,
          modal: document.getElementById('rejectModal').value,
          tahap1: document.getElementById('rejectTahap1').value,
          tahap2: document.getElementById('rejectTahap2').value,
          alt1: document.getElementById('rejectAlt1').value,
          note: document.getElementById('rejectNote').value.trim()
        };

        // Tampilkan popup garansi ditolak untuk preview
        NewPopups.showGaransiDitolak(formData);
        System.showNotification('Preview Surat', 'Preview surat garansi ditolak', 'info');
      }

      async processLoanForm() {
        if (!this.validateLoanForm()) {
          System.showNotification('Validasi Gagal', 'Harap lengkapi semua field yang wajib diisi', 'error');
          return;
        }

        const formData = {
          nama: document.getElementById('loanNama').value.trim(),
          alamat: document.getElementById('loanAlamat').value.trim(),
          nik: document.getElementById('loanNik').value.trim(),
          akun: document.getElementById('loanAkun').value.trim(),
          jumlah: document.getElementById('loanJumlah').value,
          skema: document.getElementById('loanSkema').value,
          catatan: document.getElementById('loanCatatan').value.trim(),
          timestamp: new Date().toISOString(),
          id: `PINJAMAN-${Date.now()}-${Math.random().toString(36).substr(2, 4).toUpperCase()}`
        };

        this.saveToStorage('loan', formData);
        
        await new Promise(resolve => setTimeout(resolve, 100));
        Modals.showLoanAgreement(formData);
        
        System.showNotification('Surat Berhasil', 'Surat pinjaman berhasil dibuat', 'success');
      }

      validateLoanForm() {
        const requiredFields = [
          'loanNama',
          'loanAlamat',
          'loanNik',
          'loanAkun',
          'loanJumlah',
          'loanSkema'
        ];

        let isValid = true;

        requiredFields.forEach(fieldId => {
          const field = document.getElementById(fieldId);
          const value = field.value.trim();
          
          if (!value) {
            field.classList.add('border-rose-500', 'ring-2', 'ring-rose-200');
            setTimeout(() => {
              field.classList.remove('border-rose-500', 'ring-2', 'ring-rose-200');
            }, 3000);
            isValid = false;
          }
        });

        const nik = document.getElementById('loanNik').value.trim();
        if (nik.length !== 16) {
          System.showNotification('NIK Tidak Valid', 'NIK harus 16 digit', 'error');
          isValid = false;
        }

        return isValid;
      }

      previewLoanForm() {
        if (!this.validateLoanForm()) {
          System.showNotification('Validasi Gagal', 'Harap lengkapi semua field yang wajib diisi', 'error');
          return;
        }

        const formData = {
          nama: document.getElementById('loanNama').value.trim(),
          alamat: document.getElementById('loanAlamat').value.trim(),
          nik: document.getElementById('loanNik').value.trim(),
          akun: document.getElementById('loanAkun').value.trim(),
          jumlah: document.getElementById('loanJumlah').value,
          skema: document.getElementById('loanSkema').value,
          catatan: document.getElementById('loanCatatan').value.trim()
        };

        Modals.showLoanAgreement(formData);
        System.showNotification('Preview Surat', 'Preview surat pinjaman nasabah', 'info');
      }

      async processWithdrawalForm() {
        if (!this.validateWithdrawalForm()) {
          System.showNotification('Validasi Gagal', 'Harap lengkapi semua field yang wajib diisi', 'error');
          return;
        }

        const formData = {
          nama: document.getElementById('withdrawalNama').value.trim(),
          akun: document.getElementById('withdrawalAkun').value.trim(),
          perusahaan: document.getElementById('withdrawalPerusahaan').value.trim(),
          tanggal: document.getElementById('withdrawalTanggal').value.trim(),
          catatan: document.getElementById('withdrawalCatatan').value.trim(),
          timestamp: new Date().toISOString(),
          id: `PENARIKAN-${Date.now()}-${Math.random().toString(36).substr(2, 4).toUpperCase()}`
        };

        this.saveToStorage('withdrawal', formData);
        
        await new Promise(resolve => setTimeout(resolve, 100));
        Modals.showWithdrawalAgreement(formData);
        
        System.showNotification('Perjanjian Berhasil', 'Perjanjian penarikan berhasil dibuat', 'success');
      }

      validateWithdrawalForm() {
        const requiredFields = [
          'withdrawalNama',
          'withdrawalAkun',
          'withdrawalPerusahaan',
          'withdrawalTanggal'
        ];

        let isValid = true;

        requiredFields.forEach(fieldId => {
          const field = document.getElementById(fieldId);
          const value = field.value.trim();
          
          if (!value) {
            field.classList.add('border-rose-500', 'ring-2', 'ring-rose-200');
            setTimeout(() => {
              field.classList.remove('border-rose-500', 'ring-2', 'ring-rose-200');
            }, 3000);
            isValid = false;
          }
        });

        return isValid;
      }

      previewWithdrawalForm() {
        if (!this.validateWithdrawalForm()) {
          System.showNotification('Validasi Gagal', 'Harap lengkapi semua field yang wajib diisi', 'error');
          return;
        }

        const formData = {
          nama: document.getElementById('withdrawalNama').value.trim(),
          akun: document.getElementById('withdrawalAkun').value.trim(),
          perusahaan: document.getElementById('withdrawalPerusahaan').value.trim(),
          tanggal: document.getElementById('withdrawalTanggal').value.trim(),
          catatan: document.getElementById('withdrawalCatatan').value.trim()
        };

        Modals.showWithdrawalAgreement(formData);
        System.showNotification('Preview Surat', 'Preview perjanjian penarikan dana', 'info');
      }

      resetForm(type) {
        if (!confirm(`Reset semua data form ${this.getFormTitle(type)}?`)) {
          return;
        }

        const fields = this.getFormFields(type);

        fields.forEach(fieldId => {
          document.getElementById(fieldId).value = '';
        });

        // Reset specific fields
        if (type === 'loan') {
          document.getElementById('charCountLoan').textContent = '0/500';
        } else if (type === 'withdrawal') {
          document.getElementById('withdrawalPerusahaan').value = 'NEEX CORPORATION';
          const now = new Date();
          const options = { day: '2-digit', month: 'long', year: 'numeric' };
          document.getElementById('withdrawalTanggal').value = `Jakarta, ${now.toLocaleDateString('id-ID', options)}`;
          document.getElementById('charCountWithdrawal').textContent = '0/500';
        } else if (type === 'lock') {
          document.getElementById('lockHasil').value = '';
          document.getElementById('charCountLock').textContent = '0/500';
        } else if (type === 'reject') {
          document.getElementById('charCountReject').textContent = '0/500';
        }

        this.clearStorage(type);

        System.showNotification('Form Direset', `${this.getFormTitle(type)} berhasil direset`, 'info');
      }

      getFormTitle(type) {
        const titles = {
          'lock': 'Penguncian Paket',
          'reject': 'Garansi Ditolak',
          'loan': 'Pengajuan Pinjaman',
          'withdrawal': 'Perjanjian Penarikan'
        };
        return titles[type] || 'Form';
      }

      getFormFields(type) {
        const fields = {
          'lock': ['lockEmail', 'lockPaket', 'lockTahap', 'lockModal', 'lockProfit', 'lockNote'],
          'reject': ['rejectEmail', 'rejectPaket', 'rejectModal', 'rejectTahap1', 'rejectTahap2', 'rejectAlt1', 'rejectNote'],
          'loan': ['loanNama', 'loanAlamat', 'loanNik', 'loanAkun', 'loanJumlah', 'loanSkema', 'loanCatatan'],
          'withdrawal': ['withdrawalNama', 'withdrawalAkun', 'withdrawalCatatan']
        };
        return fields[type] || [];
      }

      copyResult() {
        const hasil = document.getElementById('lockHasil').value;
        if (!hasil) return;

        navigator.clipboard.writeText(hasil).then(() => {
          System.showNotification('Clipboard', 'Hasil berhasil disalin ke clipboard', 'info');
        });
      }

      saveToStorage(type, data) {
        const key = `asiang_${type}_${Date.now()}`;
        localStorage.setItem(key, JSON.stringify(data));
        this.updateSavedCount();
      }

      clearStorage(type) {
        Object.keys(localStorage).forEach(key => {
          if (key.startsWith(`asiang_${type}_`)) {
            localStorage.removeItem(key);
          }
        });
        this.updateSavedCount();
      }

      updateSavedCount() {
        let count = 0;
        for (let i = 0; i < localStorage.length; i++) {
          if (localStorage.key(i).startsWith('asiang_')) {
            count++;
          }
        }
        const savedCountElement = document.getElementById('savedCount');
        if (savedCountElement) {
          savedCountElement.textContent = count;
        }
      }

      loadSavedData() {
        this.updateSavedCount();
      }
    }

    // ===== GLOBAL FUNCTIONS =====
    function formatCurrency(input) {
      let value = input.value.replace(/\./g, '');
      if (!isNaN(value) && value !== '') {
        input.value = parseInt(value).toLocaleString('id-ID');
        
        // Trigger calculation if it's lock modal field
        if (input.id === 'lockModal') {
          if (app && typeof app.calculateLockResult === 'function') {
            app.calculateLockResult();
          }
        }
      }
    }

    // Initialize application
    let app;
    window.addEventListener('DOMContentLoaded', () => {
      app = new AsiApp();
    });

    // Add CSS for progress animation
    const style = document.createElement('style');
    style.textContent = `
      @keyframes shrink {
        from { width: 100%; }
        to { width: 0%; }
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>